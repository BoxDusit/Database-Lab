--?????????? ?????? ????? ???????????????? ????????
SELECT Region , Country , Companyname,Phone
FROM Customers
ORDER BY 1 asc , 2 asc, 3 asc

--??????????????calculate ??????
SELECT ProductID , ProductName ,UnitPrice,UnitsInStock,UnitPrice*UnitsInStock as StockValue
FROM Products

--??????????????????? Alias / as
SELECT ProductID as ???? , ProductName as ??????????, ????????????????????????? = UnitsInStock+UnitsOnOrder 
FROM Products
WHERE (UnitsInStock + UnitsOnOrder) < ReorderLevel

--????????????????????? round(???????,???????????)
SELECT ProductID,ProductName,UnitPrice,ROUND(UnitPrice * 0.07,2) as Vat7
FROM Products


--??????????????????????????????????? Spaace(????????????)
SELECT EmployeeID , TitleOfCourtesy+FirstName+SPACE(2)+LastName as [Employee Name]
FROM Employees

SELECT EmployeeID , TitleOfCourtesy+FirstName+' '+LastName as [Employee Name]
FROM Employees

--??????????????????????????????? [order details]
SELECT OrderID,ProductID,UnitPrice,Quantity,Discount,
(UnitPrice*Quantity) as TotalPrice,
 NetPrice = (UnitPrice*Quantity*(1-Discount)) ,
(UnitPrice*Quantity)-(UnitPrice*Quantity*Discount) as NetPrice
FROM [Order Details]

--??????????????????????? getdate() ???????????????? datediff(??,???????,??????????????)
SELECT EmployeeID,FirstName,BirthDate,DATEDIFF(YEAR,BirthDate,GETDATE())Age,HireDate,DATEDIFF(YEAR,HireDate,GETDATE()) YearInOffice
FROM Employees


--???????????????????? MIN MAX SUM AVG COUNT ?????????????
--????????????????????????????????????????????????????? 15 ????
SELECT COUNT(*) AS ??????????? , COUNT(ProductID),COUNT(ProductName)
FROM Products
WHERE UnitsInStock < 15

--?????????????????????????? usa 
SELECT COUNT(*) AS ??????????????????????????USA
FROM Customers
WHERE Country = 'usa'

--????????????????????? London
SELECT COUNT(*)
FROM Employees
WHERE City = 'london'

--??????????????????????? 1997
SELECT COUNT(*) 
FROM Orders
WHERE year(OrderDate) = 1997

--??????????????????????
SELECT COUNT(*)
FROM [Order Details] 
WHERE ProductID=1

--Function Sum
--??????????????????????????? ??????????????? 1
SELECT SUM(quantity)
FROM [Order Details]
WHERE ProductID = 2

--?????????????????????????
SELECT SUM(UnitPrice * UnitsInStock)
FROM Products

--????????????????????? 8 ????????????????
SELECT SUM(UnitsOnOrder)
FROM Products
WHERE CategoryID = 8 

--Function Min Max
SELECT MAX(UnitPrice), MIN(UnitPrice)
FROM [Order Details]
WHERE ProductID =  71

--Function AVG
--??????????????????????????????????????????????????5
SELECT AVG(UnitPrice),MAX(UnitPrice), MIN(UnitPrice)
FROM [Order Details]
WHERE ProductID = 5


--??????????????????????????????
SELECT Country,COUNT(*) as [Num of Country]
FROM Customers
GROUP BY Country

--???????????????? ????????????????????????????????
SElECT CategoryID,AVG(UnitPrice),MAX(UnitPrice), MIN(UnitPrice)
FROM Products
GROUP BY CategoryID

--???????????????????????? 10250
SELECT OrderID , COUNT(*)
FROM [Order Details]
GROUP BY OrderID
HAVING COUNT(*)>3
--???????????????????????????????????????????????????
SELECT ShipCountry,COUNT(*)
FROM Orders
GROUP BY ShipCountry



--??????????????????? groupby
SELECT ShipCountry,COUNT(*) as "Num of Country"
FROM Orders
GROUP BY ShipCountry
HAVING COUNT(*) >= 100

--?????????????????????????????????????????????? ???????????????????????????????????????? 100
SELECT OrderID , SUM(UnitPrice*Quantity*(1-Discount)) as ??????????
FROM [Order Details]
GROUP BY OrderID
HAVING SUM(UnitPrice*Quantity*(1-Discount))<100

--????????????????????????????????????????????? 20 ?????????? 1997
SELECT ShipCountry,COUNT(*) as NumOfOrder
FROM Orders
WHERE YEAR(OrderDate) = 1997
GROUP BY ShipCountry
HAVING COUNT(*) < 20
ORDER BY COUNT(*) DESC

--?????????????????????????????????????????????????????????? 1 ??????
SELECT top 1 OrderID, SUM(UnitPrice*Quantity*(1-Discount)) as total
FROM [Order Details]
GROUP BY OrderID
ORDER BY total desc

--?????????????????????????????????????????????????????????? 5 ??????
SELECT top 5 OrderID, SUM(UnitPrice*Quantity*(1-Discount)) as total
FROM [Order Details]
GROUP BY OrderID
ORDER BY total asc
